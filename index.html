<!DOCTYPE html>
<html lang="en">
  <head>
    <style id="page-hide">body{visibility:hidden}</style>
    <meta charset="UTF-8" />
    <link rel="icon" href="/lovable-uploads/6ae2b882-22a7-4999-9254-825d31ea2b05.png" type="image/png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StartWise - Turn Your Ideas Into Real Businesses</title>
    <meta name="description" content="We help entrepreneurs validate, design, and launch successful startups. From feasibility studies to MVP development - your complete tech partner with 98% success rate." />
    <meta name="keywords" content="startup development, MVP development, business validation, feasibility study, UI UX design, entrepreneur services" />
    <meta name="author" content="StartWise" />

    <meta property="og:title" content="StartWise - Turn Your Ideas Into Real Businesses" />
    <meta property="og:description" content="We help entrepreneurs validate, design, and launch successful startups. From feasibility studies to MVP development - your complete tech partner with 98% success rate." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://startwise.com/og-image.jpg" />
    <meta property="og:url" content="https://startwise.com" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="StartWise - Turn Your Ideas Into Real Businesses" />
    <meta name="twitter:description" content="We help entrepreneurs validate, design, and launch successful startups. From feasibility studies to MVP development - your complete tech partner with 98% success rate." />
    <meta name="twitter:image" content="https://startwise.com/og-image.jpg" />
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>
    
    <!-- Dynamic Hero Copy Script -->
    <script>
    (function() {
      // Get keyword from URL parameter
      const urlParams = new URLSearchParams(window.location.search);
      const keyword = urlParams.get('keyword');
      
      if (!keyword) {
        console.log('[Dynamic Hero] No keyword parameter found, using default content');
        // No keyword, let page reveal normally with default content
        return;
      }

      console.log('[Dynamic Hero] Loading variant for keyword:', keyword);

      // Detect if mobile or desktop
      const isMobile = window.innerWidth < 768;

      // Fetch approved variant from database
      fetch('https://fhomiyajinehlpxbwjxl.supabase.co/functions/v1/serve-variant?keyword=' + encodeURIComponent(keyword))
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            console.error('[Dynamic Hero] Variant fetch error:', data.error);
            return;
          }

          console.log('[Dynamic Hero] Variant data received:', data);

          // Wait for hero container to exist
          function updateHero() {
            const heroContainer = document.querySelector('[data-hero-container]');
            
            if (!heroContainer) {
              console.log('[Dynamic Hero] Hero container not found yet, retrying...');
              setTimeout(updateHero, 50);
              return;
            }

            // Get the appropriate text (desktop or mobile)
            const heroText = isMobile ? (data.subheadline || data.headline) : data.headline;
            
            // Replace entire content with the full hero text
            heroContainer.innerHTML = '<div style="white-space: pre-wrap;">' + heroText + '</div>';
            
            console.log('[Dynamic Hero] Content updated, triggering reveal');
            
            // Trigger reveal after content is updated
            if (window.__HERO_READY__) {
              window.__HERO_READY__();
            }
          }
          
          updateHero();
        })
        .catch(error => {
          console.error('[Dynamic Hero] Error loading dynamic content:', error);
          // On error, let page reveal with default content
        });
    })();
    </script>
    
    <!-- Page Reveal Script -->
    <script>
    (function(){
      console.log('[Page Reveal] Script starting');
      
      var revealed = false;
      
      function reveal(){
        if (revealed) return;
        revealed = true;
        
        var s=document.getElementById('page-hide');
        if(s&&s.parentNode){
          console.log('[Page Reveal] Revealing page');
          s.parentNode.removeChild(s);
        }
      }
      
      function hasHero(){
        var el=document.querySelector('[data-hero-container]');
        var hasContent = !!(el && el.textContent && el.textContent.trim().length>0);
        console.log('[Page Reveal] hasHero check:', hasContent, el ? 'Element found' : 'Element not found', el ? 'Text length: ' + el.textContent.trim().length : '');
        return hasContent;
      }
      
      // Expose reveal function for dynamic script to call
      window.__HERO_READY__ = reveal;
      
      // Check if we have a keyword parameter
      var urlParams = new URLSearchParams(window.location.search);
      var hasKeyword = urlParams.get('keyword');
      
      if (!hasKeyword) {
        console.log('[Page Reveal] No keyword param, revealing when hero loads normally');
        
        // No dynamic content, reveal when React renders
        if (document.readyState==='loading') {
          document.addEventListener('DOMContentLoaded', function(){
            console.log('[Page Reveal] DOMContentLoaded fired');
            setTimeout(function(){
              if(hasHero()) reveal();
            }, 100);
          });
        } else {
          setTimeout(function(){
            if(hasHero()) reveal();
          }, 100);
        }
        
        // Watch for hero container
        var obs=new MutationObserver(function(){
          if(hasHero()){
            console.log('[Page Reveal] MutationObserver detected hero content');
            reveal();
            obs.disconnect();
          }
        });
        obs.observe(document.documentElement,{childList:true,subtree:true,characterData:true});
      } else {
        console.log('[Page Reveal] Keyword param detected, waiting for dynamic script');
        // With keyword, dynamic script will call reveal after updating content
      }
      
      // Fallback timeout - always reveal eventually
      setTimeout(function(){
        console.log('[Page Reveal] Timeout fallback triggered');
        reveal();
      }, 3500);
    })();
    </script>
  </body>
</html>
